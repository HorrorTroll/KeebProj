# Treadstone32ビルドガイド
- [Treadstone32ビルドガイド](#treadstone32%E3%83%93%E3%83%AB%E3%83%89%E3%82%AC%E3%82%A4%E3%83%89)
  - [はじめに](#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB)
  - [パーツ一覧](#%E3%83%91%E3%83%BC%E3%83%84%E4%B8%80%E8%A6%A7)
    - [キット以外に必要なもの](#%E3%82%AD%E3%83%83%E3%83%88%E4%BB%A5%E5%A4%96%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E3%82%82%E3%81%AE)
  - [必要な道具](#%E5%BF%85%E8%A6%81%E3%81%AA%E9%81%93%E5%85%B7)
  - [組み立て](#%E7%B5%84%E3%81%BF%E7%AB%8B%E3%81%A6)
  - [micro USBのはんだ付け](#micro-usb%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [atmega32u4のはんだ付け](#atmega32u4%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [水晶振動子のはんだ付け](#%E6%B0%B4%E6%99%B6%E6%8C%AF%E5%8B%95%E5%AD%90%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [コンデンサのはんだ付け](#%E3%82%B3%E3%83%B3%E3%83%87%E3%83%B3%E3%82%B5%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [抵抗のはんだ付け](#%E6%8A%B5%E6%8A%97%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [リセットボタンのはんだ付け](#%E3%83%AA%E3%82%BB%E3%83%83%E3%83%88%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [ダイオードのはんだ付け](#%E3%83%80%E3%82%A4%E3%82%AA%E3%83%BC%E3%83%89%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [MXソケットのはんだ付け](#mx%E3%82%BD%E3%82%B1%E3%83%83%E3%83%88%E3%81%AE%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91)
  - [*(オプション)UnderglowLEDをはんだ付けする*](#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3underglowled%E3%82%92%E3%81%AF%E3%82%93%E3%81%A0%E4%BB%98%E3%81%91%E3%81%99%E3%82%8B)
  - [キーキャップの取り付け](#%E3%82%AD%E3%83%BC%E3%82%AD%E3%83%A3%E3%83%83%E3%83%97%E3%81%AE%E5%8F%96%E3%82%8A%E4%BB%98%E3%81%91)
  - [ケースの組み立て](#%E3%82%B1%E3%83%BC%E3%82%B9%E3%81%AE%E7%B5%84%E3%81%BF%E7%AB%8B%E3%81%A6)
  - [ファームウェアの書き込み](#%E3%83%95%E3%82%A1%E3%83%BC%E3%83%A0%E3%82%A6%E3%82%A7%E3%82%A2%E3%81%AE%E6%9B%B8%E3%81%8D%E8%BE%BC%E3%81%BF)
  - [完成！](#%E5%AE%8C%E6%88%90)
  - [キースイッチの交換方法](#%E3%82%AD%E3%83%BC%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81%E3%81%AE%E4%BA%A4%E6%8F%9B%E6%96%B9%E6%B3%95)

## はじめに

　Treadstone32はすべてチップ部品を使っており、ピッチの細かい部品のはんだ付けがあるため自作キーボードの中でも難易度は高いです。まず使用する道具はちゃんとそろえてくださいますようお願いいたします。  
　また特にmicroUSBのピンとMCUのピンはピッチが狭いため、慣れないとハンダで隣のピンをブリッジすることがあります。これを気づかずに電源を入れると最悪部品をを破損しますので重ねてご注意くださいますようお願いいたします。  

## パーツ一覧

細かいチップ部品は予備として1個多く入れています。  

| 基板番号 | 定数 | 数 | 名前 | 備考 |
| ---- | ---- | --- | --- | --- |
| C1 | 0.1uF | 2 | コンデンサ | 1uFよりも色が薄い |
| C2-C3 | 1uF | 3 | コンデンサ | 色が濃い |
| C4-C5 | 22pF | 3 | コンデンサ | 一番色が薄く、厚みもない |
| R1-R2 | 22ohm | 3 | 抵抗 | 22R0と書いてある |
| R3-R4 | 10Kohm | 3 | 抵抗 | 1002と書いてある |
| X1 | 16MHz | 1 | 水晶振動子 EPSON FA-238 | 裏にパッドが4つある |
| U1 | - | 1 | MCU atmel ATMEGA32U4-AU |  |
| J1 | - | 1 | micro USB MOLEX 47642-0001 |  |
| (D1-D32) | - | 33 | ダイオード | うっすらとシルク印刷されている |
| (SW1-SW32) | - | 32 | Kailh MX ソケット |  |
| - | M2 1.6mm | 6 | ナット |  |
| - | M2 17mm- | 6 | ボルト |  |
| - | 2mm | 6 | ゴム脚 |  |

### キット以外に必要なもの

| 名前 | 数 | 備考 |
| ---- | ---- | --- |
| キースイッチ | 32個 | MX互換のもの |
| キーキャップ | 32個 | MX互換のもの |
| *LEDストリップ（WS2812B 6個付き）* | *1個* | *Underglow用（オプション）* |

## 必要な道具

| 名前 | 備考 |
| ---- | ---- |
| 温調はんだごて | チップ部品は熱に弱いので温調はんだごてが必須です |
| 細めのこて先 | 1Cや2C型くらいを推奨。慣れている人ならB型でも |
| 糸ハンダ | 0.5mm程度の細いものを推奨します |
| フラックス | 必須 |
| フラックス除去剤 | フラックスを塗るので除去したほうがキレイです |
| ハンダ吸い取り線 | 失敗したとき、ハンダブリッジしたときに吸い取ります |
| ピンセット | 必須です |
| テスター | 接続確認、ブリッジしていないかの確認に必須です |
| キズミ、ルーペなど | MicroUSBやAtmega32U4のハンダブリッジを目視で確認する際に必要 |

## 組み立て

　組み立ての時間ですが、2～3時間くらい（ファーム開発環境構築からだと別途+1～2時間程度）を目安にしてください。半田ごてもってると一時間あっという間に飛びますので時々休憩を入れましょう。あとハンダの煙は吸ったり目に入れたりしないように注意しましょう。  

## micro USBのはんだ付け

　ハンダ付けするピンのピッチがかなり狭く、MicroUSBのケースの内側にピンがあるため難易度は高いので注意してください。  
　はんだ付け講座的なYoutube動画などを観てイメージトレーニングしてからやると良いでしょう。  
　隣のピンと導通していないことを目視とテスター両方で確認してください。  

## atmega32u4のはんだ付け

　micro USBのはんだ付けと同じ要領でおこなってください。  
　隣のピンと導通していないことを目視とテスター両方で確認してください。  

## 水晶振動子のはんだ付け

　水晶振動子の印刷と、基板のX1が双方正しく読める位置にあわせてハンダ付けしてください。  

## コンデンサのはんだ付け

　コンデンサはすべて積層セラミックでハンダ付けに向きはありません。  
　色が薄く一番平たいものは22pFで水晶振動子の両サイドC4,C5に取り付けます。  
　残った同じ大きさ厚さのもので、色が薄い方をC1に取り付けます。  
　一番濃い色のコンデンサをC2,C3に取り付けます。  

## 抵抗のはんだ付け

　22R0はmicro USBの下にあるR1,R2に取り付けます。  
　1002はリセットボタン付近とAtmega32U4付近にあるR3,R4に取り付けます。  

## リセットボタンのはんだ付け

　スイッチがシルク印刷に収まる方向にとりつけてください。  

## ダイオードのはんだ付け

　チップダイオードのシルクの色が薄く見えにくいですが、線が入っている方を、基板の線が入っている方に向きを合わせて取り付けてください。  
　取り付け向きはすべて一定なので、一つ取り付けたら残りも同じ方向で取り付けていってください。  

## MXソケットのはんだ付け

　まずマウントプレートにキースイッチのピンの方向に注意しながらすべてハメ込んでください。  
　次にマウントプレートと基板を合わせます。  
　合わせるとキースイッチのピンが基板から少し飛び出るので、そこにMXソケットを向きに注意しつつすべてハメ込みます。  
　ハメ込んだら、MXソケットの両端にハンダを流し込んで基板のパッドが濡れて結合されるようにハンダ付してください。  

## *(オプション)UnderglowLEDをはんだ付けする*

　テープLEDの剥離紙の両端数cmだけハサミなどでカットします。  

![img](_image/20181216-PC160176.jpg)  

　テープLEDは向きがありテープLEDの端子と基板の端子が合う向きにします。
![img](_image/20181223-PC230007.jpg)  

　Pro Microに近い一枚目はテープLED両端をはんだ付けする必要があるので、基板の両端のランドに少し被るくらいの位置にテープLEDを貼り付けてはんだ付けしてください。  

![img](_image/20181223-PC230008.jpg)  

　二枚目は片側だけですが、同じように向きに注意して貼り付けてはんだ付けしてください。  

## キーキャップの取り付け

　ケースの組み立て時、トップレイヤーとキーキャップが干渉しないように取り付ける必要があるので、先にキーキャップをハメ込んでください。  

## ケースの組み立て

　ケースのパーツは2mm厚のものと、5mm厚のものがあります。以下の順番で取り付けてください。  

| 層名 | 厚み |
| --- | --- |
| トップレイヤー | 5mm |
| マウントプレート | 1.2mm |
| ミドルレイヤー | 5mm |
| ボトムレイヤー | 2mm |
| ボトムプレート | 2mm |

## ファームウェアの書き込み

　Treadstone32は本家QMKにマージしておりませんので、私のフォークリポジトリの**my_customize**ブランチにあるものをお使いください。  
  [marksard/qmk_firmware](https://github.com/marksard/qmk_firmware/tree/my_customize)

　Treadstone32のキーマップのmakeは ```make treadstone32:like_jis``` で可能です。（Linux、Mac、MSYS2環境上なら ```make treadstone32:like_jis:dfu``` で書き込みも出来ます）  
　キーマップについての解説は[ここにあります](https://github.com/marksard/qmk_firmware/blob/my_customize/keyboards/treadstone32/keymaps/like_jis/readme_jp.md)。  

　QMKのmake環境から構築する場合、Windowsの方はMSYS2を使うか、WSL(Windows Subsystem for Linux)を使う方法があります。MSYS2での書き込み方は[さぼてんさん](https://twitter.com/cactusman)作成の記事[プログラマーではない人向けのQMK Firmware入門](https://qiita.com/cactusman/items/ac41993d1682c6d8a12e)を、WSLは[qmk_firmwareをWindows上でmakeする方法](https://qiita.com/marksard/items/f381caf3ca981f307f64)を参照してファームウェアを書き込める環境を作ってください。  
　Macな方はDocker使うほうが確実かもしれません。[自作キーボードに手を出した](https://poyo.hatenablog.jp/entry/2018/10/08/003800) の後半に記述があります。  

## 完成！

　チェックして問題なさそうなら完成です！あなただけの一台に仕上げてください！

## キースイッチの交換方法

　手では取り外しにくいため、amazonなどで販売されているキースイッチ引き抜き工具を使用して交換してください。  
